"use strict";(self.webpackChunkast_block_templates=self.webpackChunkast_block_templates||[]).push([[140],{3140:function(e,t,r){r.r(t),r.d(t,{default:function(){return C}});var o=r(5711),s=r(5940),a=r(7363),n=r(7009),l=r(5806),c=r(5302),i=r(8096),u=r(10),p=r(63),d=r(6486),g=r(2154),m=r(972);function y(){return y=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},y.apply(this,arguments)}const{site_url:f}=ast_block_template_vars;var b=(0,o.Z)((0,s.Z)((e=>{const{getFilterBlocksByCategory:t,getFilterBlocksPagesByCategory:r}=e("ast-block-templates");return{filterBlocksByCategory:t(),filterBlocksPagesByCategory:r()}})),(0,i.Z)((e=>{const{setFavorites:t,setFilterBlocksByCategory:r,setFilterBlocksPagesByCategory:o}=e("ast-block-templates");return{setFavorites:t,setFilterBlocksByCategory:r,setFilterBlocksPagesByCategory:o}})))((e=>{let{item:t,className:r,setFavorites:o,setFilterBlocksByCategory:s,filterBlocksByCategory:l,filterBlocksPagesByCategory:i,setFilterBlocksPagesByCategory:b,...h}=e;const{favorites:v,currentScreen:k}=(0,c.Z)((e=>{const{getFavorites:t,getCurrentScreen:r}=e("ast-block-templates");return{favorites:t(),currentScreen:r()}})),w="all-blocks-grid"===k?"block":"page",[_,E]=(0,a.useState)(v[w]?.includes(+t.ID));return React.createElement("button",y({className:(0,n.AK)("flex items-center justify-center rounded-full p-2 bg-white cursor-pointer border border-solid border-border-primary focus:outline-none",_?"":"text-icon-secondary",r),onClick:async e=>{e?.preventDefault(),e?.stopPropagation();try{await(0,u.Z)({path:`${f}/wp-json/gutenberg-templates/v1/favorite`,data:{type:t.type,block_id:t.ID,status:!_},method:"POST",headers:{"X-WP-Nonce":ast_block_template_vars.rest_api_nonce,"content-type":"application/json"}})}catch(e){console.error(e)}let r={...v};r=_?{...v,[w]:v[w].filter((e=>e!==(0,d.parseInt)(t.ID)))}:{...v,[w]:[...new Set([...v[w],(0,d.parseInt)(t.ID)])]},E(!_),o(r),r[w].length||"favorite"!==l&&"favorite"!==i||("block"===w&&s(""),"page"===w&&b(""),g.Z.emit("reset-list-count"))}},h),React.createElement(m.Z,{content:_?"Remove from favorites":"Add to favorites"},React.createElement(p.Z,{className:(0,n.AK)("w-5 h-5 transition-colors ease-out duration-150",_?"fill-favorite text-favorite":"hover:fill-favorite hover:text-favorite")})))}));const h=e=>{const t=["skip","logo","fav-icon"];for(const r of t)if(e.includes(r))return!0;return!1},v={linearTween(e,t,r,o){return r*e/o+t},easeInQuad(e,t,r,o){return r*(e/=o)*e+t},easeOutQuad(e,t,r,o){return-r*(e/=o)*(e-2)+t},easeInOutQuad(e,t,r,o){return(e/=o/2)<1?r/2*e*e+t:-r/2*(--e*(e-2)-1)+t},easeInCubic(e,t,r,o){return r*(e/=o)*e*e+t},easeOutCubic(e,t,r,o){return e/=o,r*(--e*e*e+1)+t},easeInOutCubic(e,t,r,o){return(e/=o/2)<1?r/2*e*e*e+t:r/2*((e-=2)*e*e+2)+t}};Object.seal(v);var k=v;const{spectra_common_styles:w,is_rtl:_}=ast_block_template_vars,E="visible";var C=(0,o.Z)((0,s.Z)((e=>{const{getDisableAi:t,getDisablePreview:r,getTogglePopup:o}=e("ast-block-templates");return{disableAi:t(),disablePreview:r(),togglePopup:o()}})))((0,a.memo)((e=>{let{item:t,content:r,stylesheet:o,astraCustomizer:s,globalStylesheet:c,colorPalette:i,dynamicContent:u,selectedImages:p,disableAi:d,togglePopup:g,email:m,phone:y,address:f}=e;const v=(0,a.useRef)(null),C=(0,a.useRef)(null),B=t["thumbnail-image-url"]||"",x=t["featured-image-url"]||"";let P=0,R=0,O=0;const[I,$]=(0,a.useState)({importing:!1}),[N,S]=(0,a.useState)(`${ast_block_template_vars.uri}dist/placeholder_200_200.png`),[A,j]=(0,a.useState)(`${ast_block_template_vars.uri}dist/placeholder_200_200.png`);function T(){const e=v?.current,t=C?.current;if(!e||!t)return;const r=e.parentNode.offsetWidth/1200,o=r*t.offsetHeight;e.style.transform=`scale(${r})`,e.style.height=`${o}px`}(0,a.useLayoutEffect)((()=>{let e=!0;const a={landscape:[],portrait:[]};p?.forEach((e=>{"landscape"===e.orientation?a.landscape.push(e):a.portrait.push(e)}));const n=a,l=new Image;l.src=B;const g=new Image;g.src=x;const b=C.current;function v(t,r){e&&(t.onload=()=>{r(t.src)})}v(l,S),v(g,j);const k=document.getElementById("astra-wp-editor-styles-inline-css")?.textContent.replace(/:root/g,".block-container").replace(/body/g,".block-container"),_=document.getElementById("astra-block-editor-styles-inline-css")?.textContent.replace(/:root/g,".block-container").replace(/body/g,".block-container");let I="";var $,N,A;if(o&&($=o,N=n?.landscape,o=d?$:0!==Object.keys(u).length&&u.hasOwnProperty(t.category)?N&&0===N.length?$:$.replace(/background-image\s*:\s*url\(['"]?([^'")]+)['"]?\)/g,(function(e,t){if(h(t))return e;if(!N[O]?.url)return"";const r=N[O]?.url;return O++,O%=N.length,'background-image: url("'+r+'")'})):$),I+=s?`<style type="text/css" id="gt-astra-customizer">${s}</style>`:"",I+=`<style type="text/css" id="gt-spectra-common-stylesheet">${w}</style>`,I=o?`${I} <style type="text/css" id="gt-common-stylesheet">${o}</style>`:I,c&&(I+=`<style type="text/css" id="gt-global-stylesheet"> ${c} </style>`),k&&(I+=`<style type="text/css" id="gt-wpeditor-css" > ${k} </style>`),_&&(I+=`<style type="text/css" id="gt-blockeditor-css"> ${_} </style>`),b&&r){let e=b.shadowRoot;if(null===e&&(e=b.attachShadow({mode:"open"})),null===e)return;let o=r;if(!d){const e=u?u[t.category]:[];e&&Object.keys(e)?.length>0&&Object.keys(e).forEach((t=>{o=null!==e[t]?o.replace(t,e[t]):o})),Object.keys(u).length>0&&u.hasOwnProperty(t.category)&&(A=o,m&&(A=A.replace("contact@example.com",m)),y&&(A=A.replace("202-555-0188",y)),f&&(A=A.replace("2360 Hood Avenue, San Diego, CA, 92123",f)),o=A,o=Z(o))}e.innerHTML=I+'<div class="st-block-container">'+o+"</div>",i.forEach(((t,r)=>{e?.host.style.setProperty(`--ast-global-color-${r}`,t)}));const s=b.shadowRoot.querySelectorAll("img");e&&(s.forEach((e=>{h(e.src)||d||0===n.landscape.length||0===n.portrait.length||0===Object.keys(u).length||!u.hasOwnProperty(t.category)||F(e,"hidden")})),T(),((e,r)=>{if(d)return;if(0===Object.keys(u).length||!u.hasOwnProperty(t.category))return;const o=r.landscape?r.landscape:[],s=r.portrait?r.portrait:[];0!==o.length&&0!==s.length&&e?.forEach((function(e,t){h(e.src)||(e.onload=()=>{const r=e.getAttribute("src")||"";if(r.includes("unsplash")||r.includes("pexels")||r.includes("pixabay"))return void F(e,E);const a=(e=>{const t=new Image;return t.src=e,t.width>t.height?"landscape":"portrait"})(e.src);let n;if(P=t%o.length,R=t%s.length,n="landscape"===a?o[P]:s[R],void 0!==n)if(n.url.includes("unsplash")||n.url.includes("pexels")||n.url.includes("pixabay")){if("landscape"===a?(P++,P%=o.length):(R++,R%=s.length),"PICTURE"===e.parentNode.nodeName)e.parentNode.querySelectorAll("source").forEach((e=>{e.setAttribute("srcset",n.optimized_url)})),e.parentNode.querySelector("img").setAttribute("src",n.optimized_url);else{const t=document.createElement("img");t.src=n.optimized_url,e.parentNode.replaceChild(t,e)}F(e,E)}else F(e,E);else F(e,E)},e.onerror=()=>{F(e,E)})}))})(s,n))}return()=>{e=!1}}),[t,d,u,p]),(0,a.useEffect)((()=>{const e=new ResizeObserver(T);return e.observe(document.documentElement),()=>{e&&e.disconnect()}}),[]),(0,a.useEffect)((()=>{const e=document.querySelector("#ast-block-templates-modal-wrap");if(!e)return;const t=new MutationObserver(T);return t.observe(e,{childList:!0,attributes:!0,subtree:!0}),()=>{t&&t.disconnect()}}),[]),(0,a.useEffect)((()=>{const e=C?.current;if(e){const t=e.shadowRoot;i.forEach(((e,r)=>{null!==t&&t.host.style.setProperty(`--ast-global-color-${r}`,e)}))}}),[i]);const F=(e,t)=>{e&&(e.style.visibility=t)},Z=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return f?e.replace(/(<iframe[^>]+src="https:\/\/maps\.google\.com\/maps\?q=)([^&]+)(&z=\d+&hl=en&t=m&output=embed&iwloc=near"[^>]*><\/iframe>)/g,`$1${encodeURIComponent(f)}$3`):e};let D=0,z=0;const q=(e,t,r)=>{const o=e.scrollTop,s=t-o;let a=0;const n=function(){a+=20;const t=k.linearTween(a,o,s,r);e.scrollTop=t,a<r&&(D=setTimeout(n,20))};n()};(0,a.useEffect)((()=>{g||(P=0,R=0,O=0)}),[g]);const H=_?"origin-top-right":"origin-top-left";return React.createElement("div",{className:(0,n.AK)("w-full h-fit p-5",!0===I.importing?"importing":"")},React.createElement("div",{className:"cursor-pointer relative border border-solid border-border-primary hover:border-accent-spectra transition duration-150 ease-in-out overflow-hidden group"},React.createElement("div",{className:`thumbnail left-0 m-0 min-h-[auto] overflow-visible text-left top-0 ${H} relative pointer-events-none`,ref:v},React.createElement("div",{className:"absolute w-[1200px] pointer-events-none max-h-[1600px] overflow-hidden",ref:C},!r&&React.createElement("img",{srcSet:`${A}, ${N}`,src:N,alt:"Preview"}),React.createElement("div",{className:"preview"},React.createElement("span",{className:"ast-block-templates-icon ast-block-templates-icon-search"})))),React.createElement("div",{className:"absolute inset-0 grid grid-cols-1 grid-rows-1 place-items-end",onMouseEnter:()=>{if("page"!==t.type)return;const e=C.current;D&&clearTimeout(D),z=setTimeout((()=>{q(e,e.scrollHeight,4e3)}),1e3)},onMouseLeave:()=>{z&&clearTimeout(z);const e=C.current;D&&clearTimeout(D),q(e,0,1500)}},React.createElement("div",{className:(0,n.AK)("opacity-0 group-hover:opacity-100 w-full flex items-center justify-between px-3 py-2 backdrop-blur-sm bg-white/[0.85] shadow-action-buttons transition-all duration-150 ease-in-out",!0===I.importing?"opacity-100":"")},React.createElement(l.Z,{title:"Insert",liveRequest:!0,item:t,importing:I.importing,onClick:()=>{$({...I,importing:!0})},onBlockImport:()=>{$({...I,importing:!1})}}),React.createElement(b,{item:t})))))})))}}]);